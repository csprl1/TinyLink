(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{4347:function(e,t,s){Promise.resolve().then(s.bind(s,2052))},2052:function(e,t,s){"use strict";s.d(t,{default:function(){return d}});var l=s(7437),a=s(2265);function r(e){let{onCreated:t}=e,[s,r]=(0,a.useState)(""),[n,c]=(0,a.useState)(""),[d,i]=(0,a.useState)(null),[o,x]=(0,a.useState)(null),[u,h]=(0,a.useState)(!1),m=async e=>{if(e.preventDefault(),i(null),x(null),!s.trim()){i("URL is required");return}h(!0);try{let e=await fetch("/api/links",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({url:s,code:n.trim()||void 0})}),a=await e.json();if(!e.ok){var l;i(null!==(l=a.error)&&void 0!==l?l:"Failed to create link");return}t(a),x("Link created successfully"),r(""),c("")}catch(e){i("Unexpected error")}finally{h(!1)}};return(0,l.jsxs)("form",{className:"space-y-3",onSubmit:m,children:[(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Target URL"}),(0,l.jsx)("input",{type:"url",placeholder:"https://example.com/very/long/url",className:"w-full bg-slate-950 border border-slate-700 rounded px-3 py-2 text-sm",value:s,onChange:e=>r(e.target.value)})]}),(0,l.jsxs)("div",{className:"space-y-1",children:[(0,l.jsx)("label",{className:"text-xs text-slate-400",children:"Custom code (optional, 6â€“8 alphanumeric)"}),(0,l.jsx)("input",{type:"text",maxLength:8,className:"w-full bg-slate-950 border border-slate-700 rounded px-3 py-2 text-sm",value:n,onChange:e=>c(e.target.value)})]}),d&&(0,l.jsx)("p",{className:"text-xs text-red-400 bg-red-950/30 px-3 py-2 rounded",children:d}),o&&(0,l.jsx)("p",{className:"text-xs text-emerald-400 bg-emerald-950/30 px-3 py-2 rounded",children:o}),(0,l.jsx)("button",{type:"submit",disabled:u,className:"text-sm bg-sky-600 hover:bg-sky-700 disabled:opacity-60 disabled:cursor-not-allowed px-4 py-2 rounded font-medium",children:u?"Creating...":"Create"})]})}var n=s(7138);function c(e){let{links:t,onDeleted:s}=e,a=window.location.origin,r=async e=>{window.confirm("Delete link '".concat(e,"'? It will stop redirecting."))&&((await fetch("/api/links/".concat(e),{method:"DELETE"})).ok?s(e):alert("Failed to delete"))};return(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"min-w-full text-sm",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"border-b border-slate-800 text-xs text-slate-400",children:[(0,l.jsx)("th",{className:"text-left py-2 pr-4",children:"Code"}),(0,l.jsx)("th",{className:"text-left py-2 pr-4",children:"Target URL"}),(0,l.jsx)("th",{className:"text-right py-2 pr-4",children:"Clicks"}),(0,l.jsx)("th",{className:"text-left py-2 pr-4",children:"Last clicked"}),(0,l.jsx)("th",{className:"text-right py-2",children:"Actions"})]})}),(0,l.jsx)("tbody",{children:t.map(e=>(0,l.jsxs)("tr",{className:"border-b border-slate-900 hover:bg-slate-900/40",children:[(0,l.jsx)("td",{className:"py-2 pr-4",children:(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsx)(n.default,{href:"/code/".concat(e.code),className:"text-sky-400 hover:underline",children:e.code}),(0,l.jsx)("button",{className:"text-[10px] border border-slate-600 rounded px-1.5 py-0.5",onClick:()=>navigator.clipboard.writeText("".concat(a,"/").concat(e.code)),children:"Copy"})]})}),(0,l.jsx)("td",{className:"py-2 pr-4",children:(0,l.jsx)("div",{className:"max-w-xs truncate text-slate-200",children:(0,l.jsx)("a",{href:e.url,target:"_blank",className:"hover:text-sky-300",children:e.url})})}),(0,l.jsx)("td",{className:"py-2 pr-4 text-right font-mono",children:e.clicks}),(0,l.jsx)("td",{className:"py-2 pr-4 text-xs text-slate-400",children:e.lastClicked?new Date(e.lastClicked).toLocaleString():"Never"}),(0,l.jsx)("td",{className:"py-2 text-right",children:(0,l.jsx)("button",{className:"text-xs text-red-400 hover:text-red-300",onClick:()=>r(e.code),children:"Delete"})})]},e.id))})]})})}function d(){let[e,t]=(0,a.useState)([]),[s,n]=(0,a.useState)(!0),[d,i]=(0,a.useState)(null),[o,x]=(0,a.useState)(""),u=async()=>{try{n(!0);let e=await fetch("/api/links");if(!e.ok)throw Error("Failed to load links");let s=await e.json();t(s),i(null)}catch(t){var e;i(null!==(e=t.message)&&void 0!==e?e:"Error loading links")}finally{n(!1)}};(0,a.useEffect)(()=>{u()},[]);let h=(0,a.useMemo)(()=>{if(!o.trim())return e;let t=o.toLowerCase();return e.filter(e=>e.code.toLowerCase().includes(t)||e.url.toLowerCase().includes(t))},[e,o]);return(0,l.jsxs)("main",{className:"space-y-6",children:[(0,l.jsxs)("section",{className:"bg-slate-900/60 border border-slate-800 rounded-lg p-4",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Create short link"}),(0,l.jsx)(r,{onCreated:e=>{t(t=>[e,...t])}})]}),(0,l.jsxs)("section",{className:"bg-slate-900/60 border border-slate-800 rounded-lg p-4",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 mb-3",children:[(0,l.jsx)("h2",{className:"text-lg font-semibold",children:"Links"}),(0,l.jsx)("input",{type:"text",placeholder:"Search by code or URL",className:"w-full md:w-72 text-sm bg-slate-900 border border-slate-700 rounded px-3 py-2 placeholder:text-slate-500",value:o,onChange:e=>x(e.target.value)})]}),s&&(0,l.jsx)("p",{className:"text-sm text-slate-400",children:"Loading..."}),d&&(0,l.jsx)("p",{className:"text-sm text-red-400 bg-red-950/30 px-3 py-2 rounded",children:d}),!s&&!d&&0===h.length&&(0,l.jsx)("p",{className:"text-sm text-slate-500",children:"No links yet. Create your first short link above."}),!s&&!d&&h.length>0&&(0,l.jsx)(c,{links:h,onDeleted:e=>{t(t=>t.filter(t=>t.code!==e))}})]})]})}}},function(e){e.O(0,[138,971,23,744],function(){return e(e.s=4347)}),_N_E=e.O()}]);